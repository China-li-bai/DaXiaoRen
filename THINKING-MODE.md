# æ·±åº¦æ€è€ƒæ¨¡å¼é…ç½®æŒ‡å—

## ğŸ“Š æµ‹è¯•ç»“æœ

### æœç´¢ä»»åŠ¡ï¼ˆå¯ç”¨æ·±åº¦æ€è€ƒï¼‰
- **å“åº”æ—¶é—´**: 33.8ç§’
- **å†…å®¹é•¿åº¦**: 1,227å­—ç¬¦
- **æ€è€ƒå†…å®¹**: 2,401å­—ç¬¦ï¼ˆå·²è¿‡æ»¤ï¼‰
- **çŠ¶æ€**: âœ… æˆåŠŸ

### ç”Ÿæˆä»»åŠ¡ï¼ˆå¯ç”¨æ·±åº¦æ€è€ƒï¼‰
- **å“åº”æ—¶é—´**: 50.8ç§’
- **å†…å®¹é•¿åº¦**: 1,702å­—ç¬¦
- **æ€è€ƒå†…å®¹**: 3,475å­—ç¬¦ï¼ˆå·²è¿‡æ»¤ï¼‰
- **çŠ¶æ€**: âœ… æˆåŠŸ

## âš™ï¸ é…ç½®å‚æ•°

```typescript
thinking: { 
  type: "enabled", 
  clear_thinking: true 
}
```

### å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `type` | string | "enabled" | æ˜¯å¦å¼€å¯æ€ç»´é“¾ |
| `clear_thinking` | boolean | true | æ¸…é™¤å†å²å¯¹è¯ä¸­çš„æ€è€ƒå†…å®¹ |

### type é€‰é¡¹
- **"enabled"**: å¯ç”¨æ·±åº¦æ€è€ƒæ¨¡å¼
  - GLM-4.7/GLM-4.5V: å¼ºåˆ¶æ€è€ƒ
  - GLM-4.6/GLM-4.5: æ¨¡å‹è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦æ€è€ƒ
- **"disabled"**: ç¦ç”¨æ·±åº¦æ€è€ƒæ¨¡å¼

### clear_thinking è¯´æ˜
- **true**ï¼ˆé»˜è®¤ï¼‰: å¿½ç•¥/ç§»é™¤å†å²å¯¹è¯ä¸­çš„ reasoning_content
  - é€‚ç”¨äºæ™®é€šå¯¹è¯ä¸è½»é‡ä»»åŠ¡
  - é™ä½ä¸Šä¸‹æ–‡é•¿åº¦ä¸æˆæœ¬
- **false**: ä¿ç•™å†å²å¯¹è¯ä¸­çš„ reasoning_content
  - éœ€è¦åœ¨ messages ä¸­å®Œæ•´ã€æœªä¿®æ”¹ã€æŒ‰åŸé¡ºåºé€ä¼ å†å² reasoning_content
  - ç¼ºå¤±ã€è£å‰ªã€æ”¹å†™æˆ–é‡æ’ä¼šå¯¼è‡´æ•ˆæœä¸‹é™

## ğŸ”§ ä»£ç å®ç°

### è¯·æ±‚é…ç½®

```typescript
const payload: any = {
  model: "glm-4.7-flash",
  messages: messages,
  temperature: 0.7,
  top_p: 0.9,
  thinking: { type: "enabled", clear_thinking: true }
};
```

### å“åº”å¤„ç†

```typescript
const data = await response.json();
const message = data.choices[0]?.message;

// æ£€æŸ¥æ˜¯å¦æœ‰æ€è€ƒå†…å®¹
if (message && message.reasoning_content) {
  console.log('[Thinking] Reasoning content filtered out');
  // åªè¿”å› contentï¼Œä¸è¿”å› reasoning_content
  result = message.content || "{}";
} else {
  result = data.choices[0]?.message?.content || "{}";
}
```

## âš ï¸ é‡è¦è¯´æ˜

### 1. clear_thinking çš„ä½œç”¨èŒƒå›´
- **åªå½±å“å†å²å¯¹è¯**ä¸­çš„æ€è€ƒå†…å®¹
- **ä¸å½±å“å½“å‰è¯·æ±‚**çš„æ€è€ƒå†…å®¹
- å½“å‰è¯·æ±‚çš„ reasoning_content ä»ç„¶ä¼šåœ¨ API å“åº”ä¸­è¿”å›

### 2. å¿…é¡»åœ¨ä»£ç ä¸­è¿‡æ»¤
- API å“åº”ä¸­ä¼šåŒ…å« `reasoning_content` å­—æ®µ
- å¿…é¡»åœ¨ä»£ç ä¸­æ‰‹åŠ¨è¿‡æ»¤æ‰è¿™ä¸ªå­—æ®µ
- åªè¿”å› `content` å­—æ®µç»™ç”¨æˆ·

### 3. å“åº”æ—¶é—´å½±å“
- å¯ç”¨æ·±åº¦æ€è€ƒåï¼Œå“åº”æ—¶é—´ä¼šæ˜¾è‘—å¢åŠ 
- æœç´¢ä»»åŠ¡: ~33ç§’ï¼ˆvs ç¦ç”¨æ€è€ƒ ~8ç§’ï¼‰
- ç”Ÿæˆä»»åŠ¡: ~50ç§’ï¼ˆvs ç¦ç”¨æ€è€ƒ ~15ç§’ï¼‰

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æ¨¡å¼ | æœç´¢ä»»åŠ¡ | ç”Ÿæˆä»»åŠ¡ | è¯´æ˜ |
|------|---------|---------|------|
| **ç¦ç”¨æ€è€ƒ** | ~8ç§’ | ~15ç§’ | å¿«é€Ÿå“åº”ï¼Œé€‚åˆç®€å•ä»»åŠ¡ |
| **å¯ç”¨æ€è€ƒ** | ~33ç§’ | ~50ç§’ | æ·±åº¦æ¨ç†ï¼Œé€‚åˆå¤æ‚ä»»åŠ¡ |

## ğŸ¯ ä½¿ç”¨å»ºè®®

### é€‚åˆå¯ç”¨æ·±åº¦æ€è€ƒçš„åœºæ™¯
- å¤æ‚æ¨ç†ä»»åŠ¡
- éœ€è¦å¤šæ­¥æ€è€ƒçš„é—®é¢˜
- éœ€è¦æ·±åº¦åˆ†æçš„åœºæ™¯
- å¯¹å‡†ç¡®æ€§è¦æ±‚æé«˜çš„ä»»åŠ¡

### é€‚åˆç¦ç”¨æ·±åº¦æ€è€ƒçš„åœºæ™¯
- ç®€å•é—®ç­”
- å®æ—¶æœç´¢
- å¿«é€Ÿå“åº”éœ€æ±‚
- å¯¹é€Ÿåº¦è¦æ±‚é«˜çš„åœºæ™¯

## ğŸ§ª æµ‹è¯•è„šæœ¬

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯é…ç½®ï¼š

```bash
node test-thinking-mode.js
```

æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
- æœç´¢ä»»åŠ¡ï¼ˆå¯ç”¨æ·±åº¦æ€è€ƒï¼‰
- ç”Ÿæˆä»»åŠ¡ï¼ˆå¯ç”¨æ·±åº¦æ€è€ƒï¼‰
- éªŒè¯ reasoning_content æ˜¯å¦è¢«æ­£ç¡®è¿‡æ»¤

## ğŸ“‹ å®Œæ•´ç¤ºä¾‹

### è¯·æ±‚ç¤ºä¾‹

```javascript
const response = await fetch("https://open.bigmodel.cn/api/paas/v4/chat/completions", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Authorization": `Bearer ${API_KEY}`
  },
  body: JSON.stringify({
    model: "glm-4.7-flash",
    messages: [
      {
        role: "system",
        content: "ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œè¯·å‡†ç¡®å›ç­”é—®é¢˜ã€‚"
      },
      {
        role: "user",
        content: "è¯·åˆ†æDeepSeek V3.2ç›¸æ¯”GPT-4çš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿"
      }
    ],
    temperature: 0.7,
    top_p: 0.9,
    thinking: { type: "enabled", clear_thinking: true }
  })
});
```

### å“åº”ç¤ºä¾‹

```json
{
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": "é¦–å…ˆéœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒDeepSeek å®˜æ–¹å‘å¸ƒçš„ç‰ˆæœ¬å·ä¸­...",
        "reasoning_content": "1. åˆ†æç”¨æˆ·è¯·æ±‚ï¼š\n   - ä¸»é¢˜ï¼šDeepSeek V3.2 å¯¹æ¯” GPT-4\n   - ä»»åŠ¡ï¼šåˆ†æ DeepSeek V3.2 ç›¸å¯¹äº GPT-4 çš„..."
      }
    }
  ]
}
```

### å¤„ç†ç¤ºä¾‹

```javascript
const data = await response.json();
const message = data.choices[0]?.message;

// è¿‡æ»¤æ‰æ€è€ƒå†…å®¹
const result = message.content;
// reasoning_content å·²è¢«è¿‡æ»¤ï¼Œä¸ä¼šè¿”å›ç»™ç”¨æˆ·
```

## ğŸ‰ æ€»ç»“

é€šè¿‡é…ç½® `thinking: { type: "enabled", clear_thinking: true }`ï¼Œç³»ç»Ÿç°åœ¨èƒ½å¤Ÿï¼š

- âœ… å¯ç”¨æ·±åº¦æ€è€ƒæ¨¡å¼ï¼Œæå‡æ¨ç†è´¨é‡
- âœ… è‡ªåŠ¨è¿‡æ»¤ reasoning_contentï¼Œä¸è¾“å‡ºæ€è€ƒæ–‡æœ¬
- âœ… æ¸…é™¤å†å²å¯¹è¯ä¸­çš„æ€è€ƒå†…å®¹ï¼Œé™ä½æˆæœ¬
- âœ… ä¿æŒä»£ç ç®€æ´ï¼Œé€æ˜å¤„ç†æ€è€ƒå†…å®¹

**æ³¨æ„**: å¯ç”¨æ·±åº¦æ€è€ƒåï¼Œå“åº”æ—¶é—´ä¼šå¢åŠ  2-4 å€ï¼Œè¯·æ ¹æ®å®é™…åœºæ™¯é€‰æ‹©æ˜¯å¦å¯ç”¨ã€‚
